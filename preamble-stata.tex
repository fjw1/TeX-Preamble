% Customising included Stata code
\usepackage{fontspec}

\usepackage{accsupp}% http://ctan.org/pkg/accsupp
\newcommand{\emptyaccsupp}[1]{\BeginAccSupp{ActualText={}}#1\EndAccSupp{}}

% langugae defination
\lstdefinelanguage{Stata}{
    % Left for users to add missing commands,
    % with possibility of choosing different style.
    morekeywords=,
    % Popular add-on commands
    morekeywords=[2]{cntrade, chinafin,
                     wbopendata, spmap,
    },
    % System commands
    morekeywords=[3]{regress, summarize,
                     display,
    },
    % Keywords
    morekeywords=[4]{forvalues, if, foreach, set},
    % Built-in functions
    morekeywords=[5]{rnormal, runiform},
    morecomment=[l]{//},
    % morecomment=[l]{*},  // `*` maybe used as multiply operator. So use `//` as line comment.
    morecomment=[s]{/*}{*/},
    % morecomment=[s]{,}{//},
    % The following is used by macros, like `lags'.
    morecomment=[n][keywordstyle9]{`}{'},
    morestring=[b]",
    sensitive=true,
}

\lstdefinestyle{numbers}{
    numbers=left,
    stepnumber=1,
    numberstyle=\tiny\emptyaccsupp,
    xleftmargin=2em,
}

\lstdefinestyle{nonumbers}{
    numbers=none,
}

\lstdefinestyle{stata-plain}{
    % comment slanted and keywords bolded.
    language=Stata,
    basicstyle=\setmonofont{Consolas}\footnotesize\ttfamily,
}

\lstdefinestyle{stata-editor}{
    language=Stata,
    % size of the fonts for the code
    basicstyle=\setmonofont{Consolas}\footnotesize\ttfamily,
    % Color settings to match do-file editor style
    % Commands that are not included in the defination
    keywordstyle={\color{NavyBlue}},
    % Popular add-on commands
    keywordstyle=[2]{\color{NavyBlue}},
    % System commands
    keywordstyle=[3]{\color{NavyBlue}},
    % Keywords
    keywordstyle=[4]{\color{NavyBlue}},
    % Built-in functions like rnormal
    keywordstyle=[5]{\color{Blue}},
    % Used by macros, i.e. `lags'
    keywordstyle=[9]{\color{TealBlue}},
    stringstyle=\color{Maroon},
    commentstyle=\color{OliveGreen},
}


\lstset{
    language=Stata,
    style=stata-plain,
    % style=stata-editor,
    style=numbers,
    showstringspaces=false,
    breaklines,
    frame=single,
    % To add missing commands
    % morekeywords={xtreg, xtunitroot},
}
